<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Compiler</title>
    <style>
      #code {
        width: 600px;
        height: 300px;
      }
    </style>
  </head>
  <body>
    <div><select id="select"></select></div>
    <div>
      <textarea id="code">
var a = "a";
/**
  * @param {number} x
  * @param {number} y
  */
function add(x, y) {
  return x + y;
}
var cond = add(1, 2 * 3);
cond;
if (cond) {
  a = "b";
} else {
  a = "c";
}
a;
      </textarea>
    </div>
    <div>
      <button id="run">run</button>
    </div>
    <div id="result"></div>
    <script src="./jsjs.umd.js"></script>
    <script>
      window.onload = function () {
        const textareaDom = document.querySelector("#code");
        const buttonDom = document.querySelector("#run");
        const resultDom = document.querySelector("#result");
        window.localStorage.setItem("debug", "*");

        buttonDom.addEventListener("click", function () {
          const text = (textareaDom && textareaDom.value) || "";
          const { Jsjs, Environment } = window.jsjs;
          const interpreter = new Jsjs();
          const result = interpreter.run(text, new Environment(null));
          if (interpreter.errors.length > 0) {
            resultDom.innerHTML =
              interpreter.errors
                .map((item) => `<div>error: ${item}</div>`)
                .join("") + resultDom.innerHTM;
          } else {
            console.log(result);
            resultDom.innerHTML =
              result.map((item) => `<div>log: ${item}</div>`).join("") +
              resultDom.innerHTML;
          }
        });
      };
    </script>
  </body>
</html>
